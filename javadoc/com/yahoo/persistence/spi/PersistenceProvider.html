<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_60) on Fri Mar 31 07:36:44 UTC 2017 -->
<title>PersistenceProvider</title>
<meta name="date" content="2017-03-31">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PersistenceProvider";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6,"i10":6,"i11":6,"i12":6,"i13":6,"i14":6,"i15":6,"i16":6,"i17":6,"i18":6,"i19":6,"i20":6,"i21":6,"i22":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/yahoo/persistence/spi/PartitionState.State.html" title="enum in com.yahoo.persistence.spi"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.IncludedVersions.html" title="enum in com.yahoo.persistence.spi"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/yahoo/persistence/spi/PersistenceProvider.html" target="_top">Frames</a></li>
<li><a href="PersistenceProvider.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.yahoo.persistence.spi</div>
<h2 title="Interface PersistenceProvider" class="title">Interface PersistenceProvider</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../../com/yahoo/persistence/spi/AbstractPersistenceProvider.html" title="class in com.yahoo.persistence.spi">AbstractPersistenceProvider</a></dd>
</dl>
<hr>
<br>
<pre>public interface <a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.50">PersistenceProvider</a></pre>
<div class="block"><p>
 This interface is the basis for a persistence provider in Vespa.
 A persistence provider is used by Vespa Storage to provide an elastic stateful system.
 </p>
 <p>
 The Vespa distribution mechanisms are based on distributing "buckets"
 between the nodes in the system. A bucket is an abstract concept that
 groups a set of documents. The persistence provider can choose freely
 how to implement a bucket, but it needs to be able to access a bucket as
 a unit. The placement of these units is controlled by the distributors.
 </p>
 <p>
 A persistence provider may support multiple "partitions". One example of
 a partition is a physical disk, but the exact meaning of "partitions"
 is left to the provider. It must be able to report to the service layer though.
 </p>
 <p>
 All operations return a Result object. The base Result class only encapsulates
 potential errors, which can be <i>transient</i>, <i>permanent</i> or <i>fatal</i>.
 Transient errors are errors where it's conceivable that retrying the operation
 would lead to success, either on this data copy or on others. Permanent errors
 are errors where the request itself is faulty. Fatal errors are transient errors
 that have uncovered a problem with this instance of the provider (such as a failing disk),
 and where the provider wants the process to be shut down.
 </p>
 <p>
 All write operations have a timestamp. This timestamp is generated
 by the distributor, and is guaranteed to be unique for the bucket we're
 writing to. A persistence provider is required to store "entries" for each of
 these operations, and associate the timestamp with that entry.
 Iteration code can retrieve these entries, including entries
 for remove operations. The provider is not required to keep any history beyond
 the last operation that was performed on a given document.
 </p>
 <p>
 The contract for all write operations is that after returning from the function,
 provider read methods (get, iterate) should reflect the modified state.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Interface and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.IncludedVersions.html" title="enum in com.yahoo.persistence.spi">PersistenceProvider.IncludedVersions</a></span></code>
<div class="block">The different types of entries that can be returned
 from an iterator.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.MaintenanceLevel.html" title="enum in com.yahoo.persistence.spi">PersistenceProvider.MaintenanceLevel</a></span></code>
<div class="block">The different kinds of maintenance we can do.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#createBucket-com.yahoo.persistence.spi.Bucket-">createBucket</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket)</code>
<div class="block">Tells the provider that the given bucket has been created in the
 service layer.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/CreateIteratorResult.html" title="class in com.yahoo.persistence.spi.result">CreateIteratorResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#createIterator-com.yahoo.persistence.spi.Bucket-com.yahoo.document.fieldset.FieldSet-com.yahoo.persistence.spi.Selection-com.yahoo.persistence.spi.PersistenceProvider.IncludedVersions-">createIterator</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
              <a href="../../../../com/yahoo/document/fieldset/FieldSet.html" title="interface in com.yahoo.document.fieldset">FieldSet</a>&nbsp;fieldSet,
              <a href="../../../../com/yahoo/persistence/spi/Selection.html" title="class in com.yahoo.persistence.spi">Selection</a>&nbsp;selection,
              <a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.IncludedVersions.html" title="enum in com.yahoo.persistence.spi">PersistenceProvider.IncludedVersions</a>&nbsp;versions)</code>
<div class="block">Create an iterator for a given bucket and selection criteria, returning
 a unique, non-zero iterator identifier that can be used by the caller as
 an argument to iterate and destroyIterator.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#deleteBucket-com.yahoo.persistence.spi.Bucket-">deleteBucket</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket)</code>
<div class="block">Deletes the given bucket and all entries contained in that bucket.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#destroyIterator-long-">destroyIterator</a></span>(long&nbsp;iteratorId)</code>
<div class="block">
 Destroys the iterator specified by the given id.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#flush-com.yahoo.persistence.spi.Bucket-">flush</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket)</code>
<div class="block">
 For providers that store data persistently on disk, the contract of
 flush is that data has been stored persistently so that if the node should
 restart, the data will be available.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/GetResult.html" title="class in com.yahoo.persistence.spi.result">GetResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#get-com.yahoo.persistence.spi.Bucket-com.yahoo.document.fieldset.FieldSet-com.yahoo.document.DocumentId-">get</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
   <a href="../../../../com/yahoo/document/fieldset/FieldSet.html" title="interface in com.yahoo.document.fieldset">FieldSet</a>&nbsp;fieldSet,
   <a href="../../../../com/yahoo/document/DocumentId.html" title="class in com.yahoo.document">DocumentId</a>&nbsp;id)</code>
<div class="block">Retrieves the latest version of the document specified by the
 document id.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/BucketInfoResult.html" title="class in com.yahoo.persistence.spi.result">BucketInfoResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#getBucketInfo-com.yahoo.persistence.spi.Bucket-">getBucketInfo</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket)</code>
<div class="block">If the bucket doesn't exist, return empty bucket info.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/BucketIdListResult.html" title="class in com.yahoo.persistence.spi.result">BucketIdListResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#getModifiedBuckets--">getModifiedBuckets</a></span>()</code>
<div class="block">This function is called continuously by the service layer.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/PartitionStateListResult.html" title="class in com.yahoo.persistence.spi.result">PartitionStateListResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#getPartitionStates--">getPartitionStates</a></span>()</code>
<div class="block">Returns a list of the partitions available,
 and which are up and down.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#initialize--">initialize</a></span>()</code>
<div class="block">Initializes the persistence provider.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/IterateResult.html" title="class in com.yahoo.persistence.spi.result">IterateResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#iterate-long-long-">iterate</a></span>(long&nbsp;iteratorId,
       long&nbsp;maxByteSize)</code>
<div class="block">Iterate over a bucket's document space using a valid iterator id
 received from createIterator.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#join-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.Bucket-">join</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;source1,
    <a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;source2,
    <a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;target)</code>
<div class="block">Joins two buckets into one.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/BucketIdListResult.html" title="class in com.yahoo.persistence.spi.result">BucketIdListResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#listBuckets-short-">listBuckets</a></span>(short&nbsp;partition)</code>
<div class="block">Return list of buckets that provider has stored on the given partition.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#maintain-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.PersistenceProvider.MaintenanceLevel-">maintain</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
        <a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.MaintenanceLevel.html" title="enum in com.yahoo.persistence.spi">PersistenceProvider.MaintenanceLevel</a>&nbsp;level)</code>
<div class="block">Allows the provider to do periodic maintenance and verification.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#move-com.yahoo.persistence.spi.Bucket-short-">move</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
    short&nbsp;partitionId)</code>
<div class="block">Moves a bucket from one partition to another.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#put-com.yahoo.persistence.spi.Bucket-long-com.yahoo.document.Document-">put</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
   long&nbsp;timestamp,
   <a href="../../../../com/yahoo/document/Document.html" title="class in com.yahoo.document">Document</a>&nbsp;doc)</code>
<div class="block">Stores the given document.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/RemoveResult.html" title="class in com.yahoo.persistence.spi.result">RemoveResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#remove-com.yahoo.persistence.spi.Bucket-long-com.yahoo.document.DocumentId-">remove</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
      long&nbsp;timestamp,
      <a href="../../../../com/yahoo/document/DocumentId.html" title="class in com.yahoo.document">DocumentId</a>&nbsp;id)</code>
<div class="block">
 Removes the document referenced by the document id.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#removeEntry-com.yahoo.persistence.spi.Bucket-long-">removeEntry</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
           long&nbsp;timestampToRemove)</code>
<div class="block">Removes the entry with the given timestamp.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/RemoveResult.html" title="class in com.yahoo.persistence.spi.result">RemoveResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#removeIfFound-com.yahoo.persistence.spi.Bucket-long-com.yahoo.document.DocumentId-">removeIfFound</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
             long&nbsp;timestamp,
             <a href="../../../../com/yahoo/document/DocumentId.html" title="class in com.yahoo.document">DocumentId</a>&nbsp;id)</code>
<div class="block">
 See remove()</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#setActiveState-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.BucketInfo.ActiveState-">setActiveState</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
              <a href="../../../../com/yahoo/persistence/spi/BucketInfo.ActiveState.html" title="enum in com.yahoo.persistence.spi">BucketInfo.ActiveState</a>&nbsp;active)</code>
<div class="block">Sets the bucket state to active or inactive.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#setClusterState-com.yahoo.persistence.spi.ClusterState-">setClusterState</a></span>(<a href="../../../../com/yahoo/persistence/spi/ClusterState.html" title="interface in com.yahoo.persistence.spi">ClusterState</a>&nbsp;state)</code>
<div class="block">Updates the persistence provider with the last cluster state.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#split-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.Bucket-">split</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;source,
     <a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;target1,
     <a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;target2)</code>
<div class="block">
 Splits the source bucket into the two target buckets.</div>
</td>
</tr>
<tr id="i22" class="altColor">
<td class="colFirst"><code><a href="../../../../com/yahoo/persistence/spi/result/UpdateResult.html" title="class in com.yahoo.persistence.spi.result">UpdateResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.html#update-com.yahoo.persistence.spi.Bucket-long-com.yahoo.document.DocumentUpdate-">update</a></span>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
      long&nbsp;timestamp,
      <a href="../../../../com/yahoo/document/DocumentUpdate.html" title="class in com.yahoo.document">DocumentUpdate</a>&nbsp;update)</code>
<div class="block">Partially modifies a document referenced by the document update.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="initialize--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialize</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.76">initialize</a>()</pre>
<div class="block">Initializes the persistence provider. This function is called exactly once when
 the persistence provider starts. If any error is returned here, the service layer
 will shut down.</div>
</li>
</ul>
<a name="getPartitionStates--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPartitionStates</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/PartitionStateListResult.html" title="class in com.yahoo.persistence.spi.result">PartitionStateListResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.82">getPartitionStates</a>()</pre>
<div class="block">Returns a list of the partitions available,
 and which are up and down.</div>
</li>
</ul>
<a name="listBuckets-short-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>listBuckets</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/BucketIdListResult.html" title="class in com.yahoo.persistence.spi.result">BucketIdListResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.87">listBuckets</a>(short&nbsp;partition)</pre>
<div class="block">Return list of buckets that provider has stored on the given partition.</div>
</li>
</ul>
<a name="setClusterState-com.yahoo.persistence.spi.ClusterState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setClusterState</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.94">setClusterState</a>(<a href="../../../../com/yahoo/persistence/spi/ClusterState.html" title="interface in com.yahoo.persistence.spi">ClusterState</a>&nbsp;state)</pre>
<div class="block">Updates the persistence provider with the last cluster state.
 Only cluster states that are relevant for the provider are supplied (changes
 that relate to the distributor will not cause an update here).</div>
</li>
</ul>
<a name="setActiveState-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.BucketInfo.ActiveState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setActiveState</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.101">setActiveState</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
                      <a href="../../../../com/yahoo/persistence/spi/BucketInfo.ActiveState.html" title="enum in com.yahoo.persistence.spi">BucketInfo.ActiveState</a>&nbsp;active)</pre>
<div class="block">Sets the bucket state to active or inactive. After this returns,
 other buckets may be deactivated, so the node must be able to serve
 the data from its secondary index or get reduced coverage.</div>
</li>
</ul>
<a name="getBucketInfo-com.yahoo.persistence.spi.Bucket-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBucketInfo</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/BucketInfoResult.html" title="class in com.yahoo.persistence.spi.result">BucketInfoResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.106">getBucketInfo</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket)</pre>
<div class="block">If the bucket doesn't exist, return empty bucket info.</div>
</li>
</ul>
<a name="put-com.yahoo.persistence.spi.Bucket-long-com.yahoo.document.Document-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>put</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.113">put</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
           long&nbsp;timestamp,
           <a href="../../../../com/yahoo/document/Document.html" title="class in com.yahoo.document">Document</a>&nbsp;doc)</pre>
<div class="block">Stores the given document.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - The timestamp for the new bucket entry.</dd>
</dl>
</li>
</ul>
<a name="remove-com.yahoo.persistence.spi.Bucket-long-com.yahoo.document.DocumentId-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>remove</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/RemoveResult.html" title="class in com.yahoo.persistence.spi.result">RemoveResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.143">remove</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
                    long&nbsp;timestamp,
                    <a href="../../../../com/yahoo/document/DocumentId.html" title="class in com.yahoo.document">DocumentId</a>&nbsp;id)</pre>
<div class="block"><p>
 Removes the document referenced by the document id.
 It is strongly recommended to keep entries for the removes for
 some period of time. For recovery to work properly, a node that
 has been down for a longer period of time than that should be totally
 erased. If not, documents that have been removed but have documents
 on nodes that have been down will be reinserted.
 </p>
 <p>
 Postconditions:
 A successful invocation of this function must add the remove to the
 bucket regardless of whether the document existed. More specifically,
 iterating over the bucket while including removes after this call
 shall yield a remove-entry at the given timestamp for the given
 document identifier as part of its result set. The remove entry
 shall be added even if there exist removes for the same document id
 at other timestamps in the bucket.
 </p>
 <p>
 Also, if the given timestamp is higher to or equal than any
 existing put entry, those entries should not be returned in subsequent
 get calls. If the timestamp is lower than an existing put entry,
 those entries should still be available.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - The timestamp for the new bucket entry.</dd>
<dd><code>id</code> - The ID to remove</dd>
</dl>
</li>
</ul>
<a name="removeIfFound-com.yahoo.persistence.spi.Bucket-long-com.yahoo.document.DocumentId-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeIfFound</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/RemoveResult.html" title="class in com.yahoo.persistence.spi.result">RemoveResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.159">removeIfFound</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
                           long&nbsp;timestamp,
                           <a href="../../../../com/yahoo/document/DocumentId.html" title="class in com.yahoo.document">DocumentId</a>&nbsp;id)</pre>
<div class="block"><p>
 See remove()
 </p>
 <p>
 Used for external remove operations. removeIfFound() has no extra
 postconditions than remove, but it may choose to <i>not</i> include
 a remove entry if there didn't already exist a put entry for the given
 entry. It is recommended, but not required, to not insert entries in this
 case, though if remove entries are considered critical it might be better
 to insert them in both cases.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - The timestamp for the new bucket entry.</dd>
<dd><code>id</code> - The ID to remove</dd>
</dl>
</li>
</ul>
<a name="removeEntry-com.yahoo.persistence.spi.Bucket-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeEntry</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.166">removeEntry</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
                   long&nbsp;timestampToRemove)</pre>
<div class="block">Removes the entry with the given timestamp. This is usually used to revert
 previously performed operations. This operation should be
 successful even if there doesn't exist such an entry.</div>
</li>
</ul>
<a name="update-com.yahoo.persistence.spi.Bucket-long-com.yahoo.document.DocumentUpdate-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>update</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/UpdateResult.html" title="class in com.yahoo.persistence.spi.result">UpdateResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.174">update</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
                    long&nbsp;timestamp,
                    <a href="../../../../com/yahoo/document/DocumentUpdate.html" title="class in com.yahoo.document">DocumentUpdate</a>&nbsp;update)</pre>
<div class="block">Partially modifies a document referenced by the document update.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - The timestamp to use for the new update entry.</dd>
<dd><code>update</code> - The document update to apply to the stored document.</dd>
</dl>
</li>
</ul>
<a name="flush-com.yahoo.persistence.spi.Bucket-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flush</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.200">flush</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket)</pre>
<div class="block"><p>
 For providers that store data persistently on disk, the contract of
 flush is that data has been stored persistently so that if the node should
 restart, the data will be available.
 </p>
 <p>
 The service layer may choose to batch certain commands. This means
 that the service layer will lock the bucket only once, then perform several
 commands, and finally get the bucket info from the bucket, and then flush it.
 This can be used to improve performance by caching the modifications, and
 persisting them to disk only when flush is called. The service layer guarantees
 that after one of these operations, flush() is called, regardless of whether
 the operation succeeded or not, before another bucket is processed in the same
 worker thread. The following operations can be batched and have the guarantees
 above:
 - put
 - get
 - remove
 - removeIfFound
 - update
 - removeEntry
 </p></div>
</li>
</ul>
<a name="get-com.yahoo.persistence.spi.Bucket-com.yahoo.document.fieldset.FieldSet-com.yahoo.document.DocumentId-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>get</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/GetResult.html" title="class in com.yahoo.persistence.spi.result">GetResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.210">get</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
              <a href="../../../../com/yahoo/document/fieldset/FieldSet.html" title="interface in com.yahoo.document.fieldset">FieldSet</a>&nbsp;fieldSet,
              <a href="../../../../com/yahoo/document/DocumentId.html" title="class in com.yahoo.document">DocumentId</a>&nbsp;id)</pre>
<div class="block">Retrieves the latest version of the document specified by the
 document id. If no versions were found, or the document was removed,
 the result should be successful, but contain no document (see GetResult).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fieldSet</code> - A set of fields that should be retrieved.</dd>
<dd><code>id</code> - The document id to retrieve.</dd>
</dl>
</li>
</ul>
<a name="createIterator-com.yahoo.persistence.spi.Bucket-com.yahoo.document.fieldset.FieldSet-com.yahoo.persistence.spi.Selection-com.yahoo.persistence.spi.PersistenceProvider.IncludedVersions-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createIterator</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/CreateIteratorResult.html" title="class in com.yahoo.persistence.spi.result">CreateIteratorResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.238">createIterator</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
                                    <a href="../../../../com/yahoo/document/fieldset/FieldSet.html" title="interface in com.yahoo.document.fieldset">FieldSet</a>&nbsp;fieldSet,
                                    <a href="../../../../com/yahoo/persistence/spi/Selection.html" title="class in com.yahoo.persistence.spi">Selection</a>&nbsp;selection,
                                    <a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.IncludedVersions.html" title="enum in com.yahoo.persistence.spi">PersistenceProvider.IncludedVersions</a>&nbsp;versions)</pre>
<div class="block">Create an iterator for a given bucket and selection criteria, returning
 a unique, non-zero iterator identifier that can be used by the caller as
 an argument to iterate and destroyIterator.

 Each successful invocation of createIterator shall be paired with
 a later invocation of destroyIterator by the caller to ensure
 resources are freed up. NOTE: this may not apply in a shutdown
 situation due to service layer communication channels closing down.

 It is assumed that a successful invocation of this function will result
 in some state being established in the persistence provider, holding
 the information required to match iterator ids up to their current
 iteration progress and selection criteria. destroyIterator will NOT
 be called when createIterator returns an error.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>selection</code> - Selection criteria used to limit the subset of
   the bucket's documents that will be returned by the iterator. The
   provider implementation may use these criteria to optimize its
   operation as it sees fit, as long as doing so does not violate
   selection correctness.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A process-globally unique iterator identifier iff the result
   is successful and internal state has been created, otherwise an
   error. Identifier must be non-zero, as zero is used internally to
   signify an invalid iterator ID.</dd>
</dl>
</li>
</ul>
<a name="iterate-long-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>iterate</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/IterateResult.html" title="class in com.yahoo.persistence.spi.result">IterateResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.300">iterate</a>(long&nbsp;iteratorId,
                      long&nbsp;maxByteSize)</pre>
<div class="block">Iterate over a bucket's document space using a valid iterator id
 received from createIterator. Each invocation of iterate upon an
 iterator that has not yet fully exhausted its document space shall
 return a minimum of 1 document entry per IterateResult to ensure progress.
 An implementation shall limit the result set per invocation to document
 entries whose combined in-memory/serialized size is a "soft" maximum of
 maxByteSize. More specifically, the sum of getSize() over all returned
 DocEntry instances should be &lt;= (maxByteSize + the size of the last
 document in the result set). This special case allows for limiting the
 result set both by observing "before the fact" that the next potential
 document to include would exceed the max size and by observing "after
 the fact" that the document that was just added caused the max size to
 be exceeded.
 However, if a document exceeds maxByteSize and not including it implies
 the result set would be empty, it must be included in the result anyway
 in order to not violate the progress requirement.

 The caller shall not make any assumptions on whether or not documents
 that arrive to--or are removed from--the bucket in the time between
 separate invocations of iterate for the same iterator id will show up
 in the results, assuming that these documents do not violate the
 selection criteria. This means that there is no requirement for
 maintaining a "snapshot" view of the bucket's state as it existed upon
 the initial createIterator call. Neither shall the caller make any
 assumptions on the ordering of the returned documents.

 The IterateResult shall--for each document entry that matches the
 selection criteria and falls within the maxByteSize limit mentioned
 above--return the following information in its result:

  -- For non-removed entries: A DocEntry where getDocumentOperation() will
     return a valid DocumentPut instance and getSize() will return the
     serialized size of the document.
  -- For removed entries: A DocEntry where getDocumentId() will
     return a valid document identifier. Remove entries shall not
     contain document instances.
  -- For meta entries: A DocEntry that shall not contain a document
     instance nor should it include a document id instance (if
     included, would be ignored by the service layer in any context
     where metadata-only is requested).

 The service layer shall guarantee that no two invocations of iterate
 will happen simultaneously/concurrently for the same iterator id.

 Upon a successful invocation of iterate, the persistence provider shall
 update its internal state to account for the progress made so that new
 invocations will cover a new subset of the document space. When an
 IterateResult contains the final documents for the iteration, i.e. the
 iterator has reached its end, setCompleted() must be set on the result
 to indicate this to the caller. Calling iterate on an already completed
 iterator must only set this flag on the result and return without any
 documents.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>iteratorId</code> - An iterator ID returned by a previous call to createIterator</dd>
<dd><code>maxByteSize</code> - An indication of the maximum number of bytes that should be returned.</dd>
</dl>
</li>
</ul>
<a name="destroyIterator-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>destroyIterator</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.321">destroyIterator</a>(long&nbsp;iteratorId)</pre>
<div class="block"><p>
 Destroys the iterator specified by the given id.
 </p>
 <p>
 IMPORTANT: this method has different invocation semantics than
 the other provider methods! It may be called from the context of
 ANY service layer thread, NOT just from the thread in which
 createIterator was invoked! The reason for this is because internal
 iterator destroy messages aren't mapped to partition threads in the
 way other messages are due to their need for guaranteed execution.
 </p>
 <p>
 This in turn implies that iterator states must be shared between
 partitions (and thus protected against cross-partition concurrent
 access).
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>iteratorId</code> - The iterator id previously returned by createIterator.</dd>
</dl>
</li>
</ul>
<a name="createBucket-com.yahoo.persistence.spi.Bucket-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createBucket</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.327">createBucket</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket)</pre>
<div class="block">Tells the provider that the given bucket has been created in the
 service layer. There is no requirement to do anything here.</div>
</li>
</ul>
<a name="deleteBucket-com.yahoo.persistence.spi.Bucket-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deleteBucket</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.334">deleteBucket</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket)</pre>
<div class="block">Deletes the given bucket and all entries contained in that bucket.
 After this operation has succeeded, a restart of the provider should
 not yield the bucket in getBucketList().</div>
</li>
</ul>
<a name="getModifiedBuckets--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getModifiedBuckets</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/BucketIdListResult.html" title="class in com.yahoo.persistence.spi.result">BucketIdListResult</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.344">getModifiedBuckets</a>()</pre>
<div class="block">This function is called continuously by the service layer. It allows
 the provider to signify whether it has done any out-of-band changes to
 buckets that need to be recognized by the rest of the system. The service
 layer will proceed to call getBucketInfo() on each of the returned buckets.
 After a call to getModifiedBuckets(), the provider should clear it's list
 of modified buckets, so that the next call does not return the same buckets.</div>
</li>
</ul>
<a name="maintain-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.PersistenceProvider.MaintenanceLevel-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>maintain</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.352">maintain</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
                <a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.MaintenanceLevel.html" title="enum in com.yahoo.persistence.spi">PersistenceProvider.MaintenanceLevel</a>&nbsp;level)</pre>
<div class="block">Allows the provider to do periodic maintenance and verification.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>level</code> - The level of maintenance to do. LOW maintenance is scheduled more
 often than HIGH maintenance, so should be cheaper.</dd>
</dl>
</li>
</ul>
<a name="split-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.Bucket-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>split</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.368">split</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;source,
             <a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;target1,
             <a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;target2)</pre>
<div class="block"><p>
 Splits the source bucket into the two target buckets.
 After the split, all documents belonging to target1 should be
 in that bucket, and all documents belonging to target2 should be
 there. The information in SplitResult should reflect
 this.
 </p>
 <p>
 Before calling this function, the service layer will iterate the bucket
 to figure out which buckets the source should be split into. This may
 result in splitting more than one bucket bit at a time.
 </p></div>
</li>
</ul>
<a name="join-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.Bucket-com.yahoo.persistence.spi.Bucket-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>join</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.374">join</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;source1,
            <a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;source2,
            <a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;target)</pre>
<div class="block">Joins two buckets into one. After the join, all documents from
 source1 and source2 should be stored in the target bucket.</div>
</li>
</ul>
<a name="move-com.yahoo.persistence.spi.Bucket-short-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>move</h4>
<pre><a href="../../../../com/yahoo/persistence/spi/result/Result.html" title="class in com.yahoo.persistence.spi.result">Result</a>&nbsp;<a href="../../../../src-html/com/yahoo/persistence/spi/PersistenceProvider.html#line.381">move</a>(<a href="../../../../com/yahoo/persistence/spi/Bucket.html" title="class in com.yahoo.persistence.spi">Bucket</a>&nbsp;bucket,
            short&nbsp;partitionId)</pre>
<div class="block">Moves a bucket from one partition to another.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>partitionId</code> - The partition to move to.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/yahoo/persistence/spi/PartitionState.State.html" title="enum in com.yahoo.persistence.spi"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../com/yahoo/persistence/spi/PersistenceProvider.IncludedVersions.html" title="enum in com.yahoo.persistence.spi"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/yahoo/persistence/spi/PersistenceProvider.html" target="_top">Frames</a></li>
<li><a href="PersistenceProvider.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
